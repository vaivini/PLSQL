
(SELECT PCPEDC.CODCLI

  FROM PCPEDI,
       PCPEDC,
       PCCLIENT,
       PCPRODUT,
       PCDEPTO,
       PCPRACA,
       PCUSUARI,
       PCFORNEC,
       PCSUPERV
 WHERE  (PCPEDC.DATA between '01-01-2021' AND '30-11-2021')
   AND PCPEDI.NUMPED = PCPEDC.NUMPED
   AND PCPEDC.CODCLI = PCCLIENT.CODCLI
   AND PCPEDI.CODPROD = PCPRODUT.CODPROD
   AND PCPRODUT.CODEPTO = PCDEPTO.CODEPTO
   AND PCPEDC.CODUSUR = PCUSUARI.CODUSUR
   AND PCPEDC.CODPRACA = PCPRACA.CODPRACA
   AND PCPEDC.DTCANCEL IS NULL
   AND PCPEDC.CODSUPERVISOR = PCSUPERV.CODSUPERVISOR
   AND PCPRODUT.CODFORNEC = PCFORNEC.CODFORNEC
   AND PCPEDC.CODFILIAL IN ('1')
   AND PCPEDC.CODUSUR IN ('4')
   AND PCPEDC.CONDVENDA NOT IN (4, 8, 10, 13, 20, 98, 99)
 GROUP BY PCPEDC.CODCLI )

minus
-- INTERSECT
--EXCEPT
--UNION ALL

(SELECT PCPEDC.CODCLI

  FROM PCPEDI,
       PCPEDC,
       PCCLIENT,
       PCPRODUT,
       PCDEPTO,
       PCPRACA,
       PCUSUARI,
       PCFORNEC,
       PCSUPERV
 WHERE  (PCPEDC.DATA between '01-01-2020' AND '31-12-2020')
   AND PCPEDI.NUMPED = PCPEDC.NUMPED
   AND PCPEDC.CODCLI = PCCLIENT.CODCLI
   AND PCPEDI.CODPROD = PCPRODUT.CODPROD
   AND PCPRODUT.CODEPTO = PCDEPTO.CODEPTO
   AND PCPEDC.CODUSUR = PCUSUARI.CODUSUR
   AND PCPEDC.CODPRACA = PCPRACA.CODPRACA
   AND PCPEDC.DTCANCEL IS NULL
   AND PCPEDC.CODSUPERVISOR = PCSUPERV.CODSUPERVISORa
   AND PCPRODUT.CODFORNEC = PCFORNEC.CODFORNEC
   AND PCPEDC.CODFILIAL IN ('1')
   AND PCPEDC.CODUSUR IN ('4')
   AND PCPEDC.CONDVENDA NOT IN (4, 8, 10, 13, 20, 98, 99)
 GROUP BY PCPEDC.CODCLI )
